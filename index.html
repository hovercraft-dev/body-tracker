<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#0d1117">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="icon.svg">
<title>Body Tracker</title>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    background: #0d1117;
    color: #c9d1d9;
    -webkit-tap-highlight-color: transparent;
  }

  body {
    display: flex;
    justify-content: center;
    padding: 2rem 1.25rem;
  }

  .app {
    width: 100%;
    max-width: 400px;
  }

  h1 {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    color: #e6edf3;
    margin-bottom: 2rem;
  }

  .field {
    margin-bottom: 1.25rem;
  }

  label {
    display: block;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: #7d8590;
    margin-bottom: 0.5rem;
  }

  input {
    width: 100%;
    padding: 1rem;
    font-size: 1.25rem;
    font-weight: 500;
    font-family: inherit;
    color: #e6edf3;
    background: #161b22;
    border: 1.5px solid #30363d;
    border-radius: 10px;
    outline: none;
    transition: border-color 0.15s;
    -webkit-appearance: none;
  }

  input:focus {
    border-color: #00e59a;
  }

  input[type="date"] {
    color-scheme: dark;
  }

  .unit {
    position: relative;
  }

  .unit::after {
    content: attr(data-unit);
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 0.875rem;
    font-weight: 600;
    color: #484f58;
    pointer-events: none;
  }

  .unit input {
    padding-right: 3rem;
  }

  button {
    width: 100%;
    padding: 1rem;
    margin-top: 0.75rem;
    font-size: 1.125rem;
    font-weight: 700;
    font-family: inherit;
    color: #0d1117;
    background: #00e59a;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: opacity 0.15s;
    -webkit-appearance: none;
  }

  button:active {
    opacity: 0.8;
  }

  button:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .toast {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%) translateY(120%);
    background: #1c2b1f;
    color: #00e59a;
    font-size: 0.9rem;
    font-weight: 600;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    border: 1px solid #238636;
    opacity: 0;
    transition: transform 0.3s ease, opacity 0.3s ease;
    pointer-events: none;
  }

  .toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }
</style>
</head>
<body>

<div class="app">
  <h1>Body Tracker</h1>
  <form id="form">
    <div class="field">
      <label for="date">Date</label>
      <input type="date" id="date" required>
    </div>
    <div class="field">
      <label for="weight">Weight</label>
      <div class="unit" data-unit="kg">
        <input type="number" id="weight" inputmode="decimal" step="0.1" min="0" max="300" placeholder="0.0" required>
      </div>
    </div>
    <div class="field">
      <label for="waist">Waist</label>
      <div class="unit" data-unit="cm">
        <input type="number" id="waist" inputmode="decimal" step="0.1" min="0" max="200" placeholder="0.0" required>
      </div>
    </div>
    <div class="field">
      <label for="hips">Hips</label>
      <div class="unit" data-unit="cm">
        <input type="number" id="hips" inputmode="decimal" step="0.1" min="0" max="200" placeholder="0.0" required>
      </div>
    </div>
    <div class="field">
      <label for="exercise">Exercise</label>
      <input type="text" id="exercise" placeholder="e.g. 30 min run">
    </div>
    <button type="submit">Submit</button>
  </form>
</div>

<div class="toast" id="toast">Logged</div>

<script>
const FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSdZ7cvfrbx6il24_B5shparhtEQjqO2faQSItEABaG2JJQQCw/formResponse';
const FIELDS = {
  date:     'entry.563529000',
  weight:   'entry.841388769',
  waist:    'entry.1933747550',
  hips:     'entry.1558876293',
  exercise: 'entry.208895798'
};

const form = document.getElementById('form');
const dateInput = document.getElementById('date');
const toast = document.getElementById('toast');

function todayStr() {
  const d = new Date();
  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
}

function resetForm() {
  form.reset();
  dateInput.value = todayStr();
}

function showToast() {
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 1800);
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const btn = form.querySelector('button');
  btn.disabled = true;

  const params = new URLSearchParams();
  params.append(FIELDS.date, dateInput.value);
  params.append(FIELDS.weight, document.getElementById('weight').value);
  params.append(FIELDS.waist, document.getElementById('waist').value);
  params.append(FIELDS.hips, document.getElementById('hips').value);
  params.append(FIELDS.exercise, document.getElementById('exercise').value);

  try {
    await fetch(FORM_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: params.toString()
    });
    showToast();
    resetForm();
  } catch (err) {
    alert('Failed to send. Check your connection.');
  } finally {
    btn.disabled = false;
  }
});

// Init
resetForm();

// Service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js');
}
</script>

</body>
</html>
